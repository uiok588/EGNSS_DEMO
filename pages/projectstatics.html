<!DOCTYPE html>
<html lang="en">
  <!-- 開始導入 共用head -->
  <script src="shared/head.js"></script>
  <!-- 結束導入 共用head -->

  <body class="d-flex flex-column position-relative">
    <!-- 開始導入 共用 header -->
    <script src="shared/header.js"></script>
    <!-- 結束導入 共用 header -->

    <main id="main" class="container d-flex flex-grow-1 py-5">
      <!-- 開始導入 共用 navbar -->
      <script src="shared/navbar.js"></script>
      <!-- 結束導入 共用 navbar -->

      <div class="d-flex col-12 col-xl-9 ps-xl-3">
        <div
          id="projectstatics"
          class="contentDiv col-12 rounded rounded-1 shadow-sm"
        >
          <a
            id="projectstaticsArea"
            title="中央內容區塊"
            accesskey="C"
            href="#projectstaticsArea"
            class="targetArea ms-3"
          >
            :::
          </a>

          <h2 class="titleText col-12 text-center mt-3 mb-4">統計數據</h2>

          <!-- 開始 內文區塊-1 -->
          <div class="m-3 mb-5">            
            <h3 class="ms-3 mb-3">一、會員統計</h3>
            <!-- 表 -->
            <table
              id="tbStaticsListUnit"
              class="tbStatics tbStyle_02 col-12 mb-3"
            >
              <tbody>
                <tr>
                  <th>統計項目</th>
                  <th class="col-5">統計量值</th>
                </tr>
                <tr>
                  <td>1.註冊會員數</td>
                  <td>1405</td>
                </tr>
                <tr>
                  <td>2.有效會員數</td>
                  <td>1165</td>
                </tr>
                <tr>
                  <td>3.審核中會員</td>
                  <td>258</td>
                </tr>
              </tbody>
            </table>
            <!-- 圖 -->
            <div class="divchart">
              <p class="ms-3 mb-3">會員類別統計：</p>
              <div id="divLegendUnit" class="divChart col-12"></div>
            </div>
          </div>
          <!-- 結束 內文區塊-1 -->

          <!-- 開始 內文區塊-2 -->
          <div class="m-3 mb-5" style="margin-top: 6rem !important">
            <h3 class="ms-3 mb-3">
              二、即時動態定位服務統計
            </h3>
            <!-- 表 -->
            <table
              id="tbStaticsListUnit"
              class="tbStatics tbStyle_02 col-12 mb-3"
            >
              <tbody>
                <tr>
                  <th>統計項目</th>
                  <th class="col-5">統計量值</th>
                </tr>
                <tr>
                  <td>01.即時動態定位服務專案(98~101年第一階段開放累計)</td>
                  <td>808</td>
                </tr>
                <tr>
                  <td>02.即時動態定位服務帳號(98~101年第一階段開放累計)</td>
                  <td>1514</td>
                </tr>
                <tr>
                  <td>03.設定帳號會員數</td>
                  <td>1242</td>
                </tr>
                <tr>
                  <td>04.RTK服務帳號數(102年1月1日後)</td>
                  <td>3503</td>
                </tr>
                <tr>
                  <td>05.上個月RTK總使用天次</td>
                  <td>5411</td>
                </tr>
              </tbody>
            </table>
            <!-- 圖 -->
            <div class="divchart">
              <p class="ms-3 mb-3">即時動態服務類型統計：</p>
              <div id="divLegend" class="divChart col-12"></div>
            </div>
          </div>
          <!-- 結束 內文區塊-2 -->

          <!-- 開始 內文區塊-3 -->
          <div class="m-3 mb-5" style="margin-top: 6rem !important">
            <h3 class="ms-3 mb-3">
              三、基準站觀測資料下載服務統計
            </h3>
            <!-- 表 -->
            <table
              id="tbStaticsListUnit"
              class="tbStatics tbStyle_02 col-12 mb-3"
            >
              <tbody>
                <tr>
                  <th>統計項目</th>
                  <th class="col-5">統計量值</th>
                </tr>
                <tr>
                  <td>01.本年度實體基準站下載數量</td>
                  <td>374</td>
                </tr>
                <tr>
                  <td>02.本年度虛擬基準站下載數量</td>
                  <td>65</td>
                </tr>
                <tr>
                  <td>03.實體基準站累計下載數量</td>
                  <td>37423</td>
                </tr>
                <tr>
                  <td>04.虛擬基準站累計下載數量</td>
                  <td>10134</td>
                </tr>
              </tbody>
            </table>
          </div>
          <!-- 結束 內文區塊-3 -->

          <!-- 開始 內文區塊-4 -->
          <div class="m-3 mb-5" style="margin-top: 6rem !important">
            <h3 class="ms-3 mb-3">
              四、衛星觀測資料後處理服務統計
            </h3>
            <!-- 表 -->
            <table
              id="tbStaticsListUnit"
              class="tbStatics tbStyle_02 col-12 mb-3"
            >
              <tbody>
                <tr>
                  <th>統計項目</th>
                  <th class="col-5">統計量值</th>
                </tr>
                <tr>
                  <td>01.本年度後處理服務申請數量</td>
                  <td>50</td>
                </tr>
                <tr>
                  <td>02.本年度後處理服務解算成功數量</td>
                  <td>45</td>
                </tr>
                <tr>
                  <td>03.後處理服務累計申請數量</td>
                  <td>7547</td>
                </tr>
                <tr>
                  <td>04.後處理服務累計解算成功數量</td>
                  <td>5744</td>
                </tr>
              </tbody>
            </table>
          </div>
          <!-- 結束 內文區塊-4 -->

          <!-- 開始 內文區塊-4 -->
          <div class="m-3 mb-5" style="margin-top: 6rem !important">
            <h3 class="ms-3 mb-3">
              五、每年營收統計
            </h3>
            <!-- 圖 -->
            <div class="divchart">
              <!-- <p class="ms-3 mb-3"></p> -->
              <div id="chartCanvasIncome" class="divChart col-12"></div>
            </div>
          </div>
          <!-- 結束 內文區塊-4 -->
        </div>
      </div>
    </main>

    <!-- 開始導入 共用 footer -->
    <script src="shared/footer.js"></script>
    <!-- 結束導入 共用 footer -->

    <!-- 開始導入 共用javascript -->
    <script src="shared/javascript.js"></script>
    <!-- 結束導入 共用javascript -->

    <!-- 開始導入 Echarts資料 -->
    <script src="/lib/echarts-5.4.1/echarts.min.js"></script>
    <script src="/lib/echarts-5.4.1/eGNSS.js"></script>
    <script src="shared/echartsExample.js"></script>
    <!-- 結束導入 Echarts資料 -->

    <script>
      // 指定圓餅圖的配置项
      var pieOption_seriesList = [
        {
          name: "Access From",
          type: "pie",
          radius: "50%",
          data: "",
          width: "100%",
          height: "140%",
          left: "-5%",
          top: "-20%",
          emphasis: {
            itemStyle: {
              shadowBlur: 10,
              shadowOffsetX: 0,
              shadowColor: "rgba(0, 0, 0, 0.5)",
            },
          },
        },
      ];
      pieOption = {
        title: {
          show: false,
        },
        tooltip: {
          trigger: "item",
        },
        legend: {
          orient: "vertical",
          left: 15,
          top: 20,
          formatter: function (name) {
            let data = pieOption.series[0].data;
            let total = 0;
            let tarValue;
            for (let i = 0; i < data.length; i++) {
              total += data[i].value;
              if (data[i].name == name) {
                tarValue = data[i].value;
              }
            }
            //let p = Math.round(((tarValue/total)*100));
            let p = (tarValue / total) * 10000;
            p = Math.round(p) / 100;
            return `${name}：${tarValue} ( ${p} %)`;
          },
        },
        series: pieOption_seriesList,
      };

      // 指定柱狀圖的配置頂
      var barOption_xAxisList = [
        {
          type: "category",
          data: "",
          axisLabel: { interval: 0, rotate: 30 },
        },
      ];
      var barOption_seriesList = [
        {
          name: "Direct",
          type: "bar",
          barWidth: "60%",
          data: "",
        },
      ];
      barOption = {
        tooltip: {
          trigger: "axis",
          axisPointer: {
            type: "shadow",
          },
        },
        grid: {
          left: "3%",
          right: "4%",
          bottom: "3%",
          containLabel: true,
        },
        legend: {
          show: true,
          formatter: "單位：萬元",
        },
        xAxis: barOption_xAxisList,
        yAxis: [
          {
            type: "value",
          },
        ],
        series: barOption_seriesList,
        formatter: function (data) {
          return data[0].axisValue + "：" + data[0].data;
        },
      };

      drawECharts();

      $(window).resize(function () {
        drawECharts();
      });
      function drawECharts() {
        $(".divChart").children().remove();
        $(".divChart").removeAttr("_echarts_instance_");

        if ($(window).width() <= 768) {
          $(".divChart").height("600px");
          pieOption_seriesList[0]["height"] = "140%";
          pieOption_seriesList[0]["left"] = "0%";
          pieOption_seriesList[0]["top"] = "0%";
          pieOption.series = pieOption_seriesList;
        } else if ($(window).width() <= 992) {
          $(".divChart").height($(this).width() / 2);
          pieOption_seriesList[0]["height"] = "140%";
          pieOption_seriesList[0]["left"] = "15%";
          pieOption_seriesList[0]["top"] = "-10%";
          pieOption.series = pieOption_seriesList;
        } else {
          $(".divChart").height($(this).width() / 3.2);
          pieOption_seriesList[0]["height"] = "140%";
          pieOption_seriesList[0]["left"] = "15%";
          pieOption_seriesList[0]["top"] = "-10%";
          pieOption.series = pieOption_seriesList;
        }

        //一、會員統計/會員類別統計
        pieOption_seriesList[0]["data"] = pieData_01;
        myChart = echarts.init(
          document.getElementById("divLegendUnit"),
          "eGNSS",
          { devicePixelRatio: 2 }
        );
        myChart.setOption(pieOption);

        //二、即時動態定位服務統計
        pieOption_seriesList[0]["data"] = pieData_02;
        myChart = echarts.init(document.getElementById("divLegend"), "eGNSS", {
          devicePixelRatio: 2,
        });
        myChart.setOption(pieOption);

        //三、每年營收統計
        barOption_xAxisList[0]["data"] = barDataX_01;
        barOption_seriesList[0]["data"] = barDataY_01;
        myChart = echarts.init(
          document.getElementById("chartCanvasIncome"),
          "eGNSS",
          { devicePixelRatio: 2 }
        );
        myChart.setOption(barOption);
      }
    </script>
  </body>
</html>
